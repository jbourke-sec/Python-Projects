<div *ngIf="viewMode; else editable">
    <div *ngIf="currentVuln.vulnid">
      <h4>Vulnerability</h4>
      <div>
        <label><strong>Vuln:</strong></label> {{ currentVuln.vulnid }}
      </div>
      <div> 
      <a
        class="badge badge-warning"
        routerLink="/vuln/{{ currentVuln.vulnid }}"
      >
        Edit
      </a>
    </div>
  
    <div *ngIf="!currentVuln">
      <br />
      <p>invalid Vulnerability...</p>
    </div>
  </div>
  </div>
  
  <ng-template #editable>
    <mat-dialog-content>
    <div *ngIf="currentVuln.vulnid" class="edit-form">
      <h2>{{ currentVuln.cve }}</h2>
      <div class="row">
        <div class="col-md-8">
      <div class="form-group">
        <mat-form-field class="example-full-width" appearance="fill">
            <mat-label for="cve">CVE</mat-label>
            <input matInput
              type="text"
              class="form-control"
              id="cve"
              [(ngModel)]="currentVuln.cve"
              name="risk"
            ></mat-form-field>
          </div>
          <div class = 'row'>
          <div class="col-md-4">
            <div class="form-group">
              <mat-form-field class="example-full-width" appearance="fill">
              <mat-label for="sla">SLA</mat-label>
              <input matInput
                type="text"
                class="form-control"
                id="sla"
                [(ngModel)]="currentVuln.baseSLA"
                name="sla"
              ></mat-form-field>
          </div></div>
          
            <div class="col-md-4">
        <div class="form-group">
          <mat-form-field appearance="fill">
          <mat-label for="threat">Threat</mat-label>
          <input matInput
            type="text"
            class="form-control"
            id="threat"
            [(ngModel)]="currentVuln.threat"
            name="threat"
          ></mat-form-field>
        </div></div>
        <div class="col-md-4">
          <div class="form-group">
          <mat-form-field class="example-full-width" appearance="fill">
          <mat-label for="cwe">CWE</mat-label>
          <input matInput
          type="text"
          class="form-control"
          id="cwe"
        [(ngModel)]="currentVuln.cwe"
        name="cwe"
  ></mat-form-field>
        </div></div>
      </div>
       
        <div class="row">
          <div class="col-md-4">
            <div class="form-group"><mat-form-field appearance="fill">
              <mat-label>Privileges Required</mat-label>
              <mat-select [value]="currentVuln.mpr"[(ngModel)]="currentVuln.mpr" name="mpr" placeholder="Select an option">        
              <mat-option *ngFor="let pr of mpr" [value]= "pr.value"> {{ pr.viewValue }} </mat-option>
              </mat-select></mat-form-field>
          </div></div>
          <div class="col-md-4">
          <div class="form-group"><mat-form-field appearance="fill">
        <mat-label>User Interaction</mat-label>
        <mat-select [value]="currentVuln.mui"[(ngModel)]="currentVuln.mui" name="mui" placeholder="Select an option">        
        <mat-option *ngFor="let ui of mui" [value]= "ui.value"> {{ ui.viewValue }} </mat-option>
      </mat-select></mat-form-field>
      </div></div>
        <div class="col-md-4">
          <div class="form-group"><mat-form-field appearance="fill">
            <mat-label>Attack Vector</mat-label>
            <mat-select [value]="currentVuln.mav"[(ngModel)]="currentVuln.mav" name="mav" placeholder="Select an option">        
              <mat-option *ngFor="let mavec of mav" [value]= "mavec.value"> {{ mavec.viewValue }} </mat-option>
          </mat-select></mat-form-field>
          </div></div></div>
          <div class = 'row'>
          <div class="col-md-4">
          <div class="form-group"><mat-form-field appearance="fill">
      <mat-label>Scope</mat-label>
      <mat-select [value]="currentVuln.ms"[(ngModel)]="currentVuln.ms" name="ms" placeholder="Select an option">        
        <mat-option *ngFor="let ms of scope" [value]= "ms.value"> {{ ms.viewValue }} </mat-option>
      </mat-select></mat-form-field>
      </div></div>
        <div class="col-md-4">
          <div class="form-group"><mat-form-field appearance="fill">
            <mat-label>Attack Complexity</mat-label>
            <mat-select [value]="currentVuln.mac"[(ngModel)]="currentVuln.mac" name="mac" placeholder="Select an option">        
              <mat-option *ngFor="let macom of mac" [value]= "macom.value"> {{ macom.viewValue }} </mat-option>
          </mat-select></mat-form-field>
          </div></div>
          <div class="col-md-4">
      <div class="form-group"><mat-form-field appearance="fill">
      <mat-label>Confidentiality Impact</mat-label>
      <mat-select [value]="currentVuln.mc"[(ngModel)]="currentVuln.mc" name="mc" placeholder="Select an option">        
      <mat-option *ngFor="let mc of mpr" [value]= "mc.value"> {{ mc.viewValue }} </mat-option>
      </mat-select></mat-form-field>
      </div></div></div>
      <div class="row">
        <div class="col-md-4">
    <div class="form-group"><mat-form-field appearance="fill">
      <mat-label>Integrity Impact</mat-label>
      <mat-select [value]="currentVuln.mi"[(ngModel)]="currentVuln.mi" name="mi" placeholder="Select an option">        
      <mat-option *ngFor="let mi of mpr" [value]= "mi.value"> {{ mi.viewValue }} </mat-option>
      </mat-select></mat-form-field>
      </div></div>
      <div class="col-md-4">   
     <div class="form-group"><mat-form-field appearance="fill">
      <mat-label>Availability Impact</mat-label>
      <mat-select [value]="currentVuln.ma"[(ngModel)]="currentVuln.ma" name="ma" placeholder="Select an option">        
      <mat-option *ngFor="let ma of mpr" [value]= "ma.value"> {{ ma.viewValue }} </mat-option>
      </mat-select></mat-form-field>
      </div></div>
        <div class="col-md-4">
      <div class="form-group"><mat-form-field appearance="fill">
      <mat-label>Remediation Level</mat-label>
      <mat-select [value]="currentVuln.rl"[(ngModel)]="currentVuln.rl" name="rl" placeholder="Select an option">        
      <mat-option *ngFor="let rl of RL" [value]= "rl.value"> {{ rl.viewValue }} </mat-option>
      </mat-select></mat-form-field>
      </div></div></div>
      <div class="row">
      <div class="col-md-4">
      <div class="form-group"><mat-form-field appearance="fill">
      <mat-label>Report Confidence</mat-label>
      <mat-select [value]="currentVuln.rc"[(ngModel)]="currentVuln.rc" name="rc" placeholder="Select an option">        
      <mat-option *ngFor="let rc of RC" [value]= "rc.value"> {{ rc.viewValue }} </mat-option>
      </mat-select></mat-form-field>
      </div></div>
        <div class="col-md-4">
      <div class="form-group"><mat-form-field appearance="fill">
      <mat-label>Exploit Code Maturity</mat-label>
      <mat-select [value]="currentVuln.ecm"[(ngModel)]="currentVuln.ecm" name="ecm" placeholder="Select an option">        
      <mat-option *ngFor="let ec of ecm" [value]= "ec.value"> {{ ec.viewValue }} </mat-option>
      </mat-select></mat-form-field>
      </div></div>
      <div class="col-md-4">
        <div class="form-group">
          <mat-form-field class="example-full-width" appearance="fill">
          <mat-label for="risk">Risk</mat-label>
          <input matInput
            type="text"
            class="form-control"
            id="risk"
            [(ngModel)]="currentVuln.risk"
            name="risk"
          ></mat-form-field>
    </div></div></div>
      <div class="row">
        <mat-form-field appearance="fill">
          <mat-label>Description</mat-label>
          <div class="form-group">
            <textarea matInput
              class="form-control"
              id="summary"
              [(ngModel)]="currentVuln.description"
              name="summary"
            ></textarea>
          </div></mat-form-field>
      </div></div>
      <div class="col-md-4">
        <div class="form-group">
            <mat-accordion>
              <mat-expansion-panel hideToggle>
                <mat-expansion-panel-header (click)="viewTags()" >
                  <mat-panel-title>
                    CPE URIs
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <div *ngFor="let Tag of taglist;">
                  {{ Tag }}
                <button mat-icon-button aria-label="deleteTag"(click)="removeTag(Tag)">
                  <mat-icon>delete</mat-icon>
                </button></div>
                <div class="form-group">
                  <label for="addtag">Add Vendor</label>
                  <input
                    type="text"
                    class="form-control"
                    id="addven"
                    [(ngModel)]="vendor"
                    name="addven"
                  />
                </div>
                <div class="form-group">
                  <label for="addtag">Add Product</label>
                  <input
                    type="text"
                    class="form-control"
                    id="addprod"
                    [(ngModel)]="tech"
                    name="addprod"
                  />
                </div>
                <button mat-raised-button
              type="submit"
              (click)="addTag(vendor, tech)"
            >
            Add Tag
            </button>
              </mat-expansion-panel>
            </mat-accordion>
        </div></div></div>
      <button mat-raised-button id="vuln-update-button"
        type="submit"
        (click)="updateVuln()"
      >
        Save
      </button>
      <button mat-raised-button id="vuln-cancel-button" (click)="closeVuln()">Go back</button>
      <p>{{ message }}</p>
    </div></mat-dialog-content>
  
    <div *ngIf="!currentVuln.vulnid">
      <br />
      <p>Cannot access this Vulnerability...</p>
    </div>
  </ng-template>